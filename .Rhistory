Aids2ann <- read.table("Aids2ann.csv", header=TRUE)
View(Aids2ann)
View(Aids2ann)
Aids2ann <- read.csv("Aids2ann.csv", header=TRUE)
View(Aids2ann)
h.state <- hist(Aids2ann$state)
h.diag <- hist(Aids2ann$diag)
h.diag
h.death <- hist(Aids2ann$death)
View(Aids2ann)
View(Aids2ann)
names(h.death)
h.death$breaks
h.death$counts
h.death$mids
h.death$density
h.death$equidist
head(Aids2ann)
dim(Aids2ann)
table(Aids2ann$state)
table(Aids2ann$sex)
table(Aids2ann$T.categ)
mu.diag <- mean(Aids2ann$diag)
sig.diag <- sd(Aids2ann$diag)
plot(Aids2ann$diag,dnorm(Aids2ann$diag,mean=mu.diag,sd=sig.diag))
mu.death <- mean(Aids2ann$death)
sig.death <- sd(Aids2ann$death)
plot(Aids2ann$death,dnorm(Aids2ann$death,mean=mu.death,sd=sig.death))
hist(Aids2ann$diag,freq=F)
points(Aids2ann$diag,dnorm(Aids2ann$diag,mean=mu.diag,sd=sig.diag))
hist(Aids2ann$death,freq=F)
points(Aids2ann$death,dnorm(Aids2ann$death,mean=mu.death,sd=sig.death))
qqnorm(Aids2ann$diag)
qqline(Aids2ann$diag)
qqnorm(Aids2ann$death)
qqline(Aids2ann$death)
barplot(table(Aids2ann$state))
barplot(table(Aids2ann$T.categ))
h.death <- hist(Aids2ann$year)
names(h.year)
h.death <- hist(Aids2ann$death)
h.year <- hist(Aids2ann$year)
names(h.year)
h.year$breaks
h.yearh$counts
h.year$counts
mu.year <- mean(Aids2ann$year)
sig.year <- sd(Aids2ann$year)
plot(Aids2ann$year,dnorm(Aids2ann$year,mean=mu.year,sd=sig.year))
hist(Aids2ann$year,freq=F)
points(Aids2ann$year,dnorm(Aids2ann$year,mean=mu.year,sd=sig.year))
qqnorm(Aids2ann$year)
qqline(Aids2ann$year)
h.age <- hist(Aids2ann$age)
names(h.age)
h.age$breaks
h.age$counts
mu.age <- mean(Aids2ann$age)
sig.age <- sd(Aids2ann$age)
plot(Aids2ann$age,dnorm(Aids2ann$age,mean=mu.age,sd=sig.age))
hist(Aids2ann$age,freq=F)
points(Aids2ann$age,dnorm(Aids2ann$age,mean=mu.age,sd=sig.age))
qqnorm(Aids2ann$age)
qqline(Aids2ann$age)
boxplot(Aids2ann$year~Aids2ann$sex)
boxplot(Aids2ann$year~Aids2ann$outcome)
boxplot(Aids2ann$age~Aids2ann$T.categ)
table(Aids2ann$sex,Aids2ann$T.categ)
unique(Aids2ann$sex)
unique(Aids2ann$diag)
unique(Aids2ann$status)
unique(Aids2ann$outcome)
unique(Aids2ann$T.categ)
unique(Aids2ann$age)
unique(Aids2ann$age)
unique(Aids2ann$X)
h.x <- hist(Aids2ann$X)
h.x
mu.x <- mean(Aids2ann$X)
sig.x <- sd(Aids2ann$X)
plot(Aids2ann$X,dnorm(Aids2ann$X,mean=mu.x,sd=sig.x))
hist(Aids2ann$X,freq=F)
points(Aids2ann$X,dnorm(Aids2ann$X,mean=mu.x,sd=sig.x))
qqnorm(Aids2ann$X)
qqline(Aids2ann$X)
head(Aids2ann)
table(Aids2ann$state)
table(Aids2ann$sex)
table(Aids2ann$T.categ)
quantile(Aids2ann$age,p=c(0,0.025,0.25,0.5,0.75,0.975,1))
quantile(Aids2ann$diag,p=c(0,0.025,0.25,0.5,0.75,0.975,1))
quantile(Aids2ann$death,p=c(0,0.025,0.25,0.5,0.75,0.975,1))
is.na(Aids2ann$state)
is.na(Aids2ann$sex)
is.na(Aids2ann$diag)
is.na(Aids2ann$death)
is.na(Aids2ann$status)
is.na(Aids2ann$T.categ)
is.na(Aids2ann$age)
is.na(Aids2ann$year)
is.na(Aids2ann$outcome)
index <- is.na(Aids2ann$state)==TRUE
index
Aids2ann$state[is.na(Aids2ann$state)]
Aids2ann$state[is.na(Aids2ann$sex)]
Aids2ann$sex[is.na(Aids2ann$sex)]
Aids2ann$state[is.na(Aids2ann$state)]
Aids2ann$sex[is.na(Aids2ann$sex)]
Aids2ann$diag[is.na(Aids2ann$diag)]
Aids2ann$death[is.na(Aids2ann$death)]
Aids2ann$status[is.na(Aids2ann$status)]
Aids2ann$T.categ[is.na(Aids2ann$T.categ)]
Aids2ann$age[is.na(Aids2ann$age)]
Aids2ann$year[is.na(Aids2ann$year)]
Aids2ann$outcome[is.na(Aids2ann$outcome)]
###
### Missing data
###
library(VIM)
install.packages("VIM")
###
### Missing data
###
library(VIM)
aggr(data14)
aggr(Aids2ann)
unique(Aids2ann$age)
h.age <- hist(Aids2ann$diag)
h.age
h.age <- hist(Aids2ann$age)
names(h.age)
h.age$breaks
h.age$counts
mu.age <- mean(Aids2ann$age)
sig.age <- sd(Aids2ann$age)
plot(Aids2ann$age,dnorm(Aids2ann$age,mean=mu.age,sd=sig.age))
hist(Aids2ann$age,freq=F)
points(Aids2ann$age,dnorm(Aids2ann$age,mean=mu.age,sd=sig.age))
qqnorm(Aids2ann$age)
qqline(Aids2ann$age)
boxplot(Aids2ann$age~Aids2ann$T.categ)
boxplot(Aids2ann$age~Aids2ann$T.categ)
t.test(age ~ T.categ, data=Aids2ann)
t.test(age ~ sex, data=Aids2ann)
unique(Aids2ann$T.categ)
sum(Aids2ann$T.categ=="blood")/length(Aids2ann$T.categ)
x <- sum(Aids2ann$T.categ=="blood")
n <- length(Aids2ann$T.categ)
p <- 0.03
prop.test(x, n, p)
table(Aids2ann$age, Aids2ann$T.categ)
chisq.test(Aids2ann$age, Aids2ann$T.categ)
boxplot(Aids2ann$year~Aids2ann$state)
chisq.test(Aids2ann$age, Aids2ann$T.categ)
chisq.test(Aids2ann$year, Aids2ann$state)
boxplot(Aids2ann$age~Aids2ann$state)
chisq.test(Aids2ann$age, Aids2ann$state)
boxplot(Aids2ann$death~Aids2ann$status)
t.test(Aids2ann$death~Aids2ann$status)
?plot
plot(Aids2ann$diag, Aids2ann$death)
plot(Aids2ann$age, Aids2ann$death)
plot(Aids2ann$age, Aids2ann$diag)
plot(Aids2ann$age, Aids2ann$diag)
mod <- glm(outcome~factor(state)+factor(sex)+diag+death+status+T.categ+age+year, family = binomial, Aids2ann)
is.factor(Aids2ann$sex)
contrasts(Aids2ann$sex)
contrasts(Aids2ann$state)
mod <- glm(outcome~factor(state)+factor(sex)+diag+death+status+T.categ+age+year, family = binomial, Aids2ann)
mod <- glm(factor(outcome)~factor(state)+factor(sex)+diag+death+status+T.categ+age+year, family = binomial, Aids2ann)
mod <- glm(factor(outcome)~factor(state)+factor(sex)+diag+death+factor(status)+factor(T.categ)+age+year, family = binomial, data = Aids2ann)
contrasts(Aids2ann$T.categ)
?glm
summary(mod)
mod <- glm(outcome~factor(state)+factor(sex)+diag+death+factor(status)+factor(T.categ)+age+year, family = binomial, data = Aids2ann)
mod <- glm(outcome~factor(state)+factor(sex)+diag+death+factor(status)+factor(T.categ)+age+year, family = binomial, data = Aids2ann, control = list(maxit = 50))
mod <- glm(outcome~factor(state)+diag+death+factor(status)+factor(T.categ)+age+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(state)+diag+death+factor(status)+age+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~diag+death+factor(status)+age+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~death+factor(status)+age+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~death+factor(status)+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~death+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~X+death+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~diag+death+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~age+death+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(T.categ)+death+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(sex)+death+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(state)+factor(sex)+death+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(state)+death+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(T.categ)+factor(state)+factor(sex)+death+year, family = binomial, data = Aids2ann)
summary(mod)
chisq.test(Aids2ann$state, Aids2ann$T.categ)
chisq.test(Aids2ann$sex, Aids2ann$T.categ)
chisq.test(Aids2ann$status, Aids2ann$T.categ)
chisq.test(Aids2ann$status, Aids2ann$state)
mod <- glm(outcome~factor(T.categ)+factor(state=="QLD")+factor(sex)+death+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(state=="QLD")+factor(sex)+death+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(T.categ)+factor(state=="QLD")+factor(sex)+death+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(status)+factor(state=="QLD")+factor(sex)+death+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~age+factor(state=="QLD")+factor(sex)+death+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~diag+factor(state=="QLD")+factor(sex)+death+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(state=="QLD")+factor(sex)+death+year, family = binomial, data = Aids2ann)
summary(mod)
model.matrix(outcome~factor(state=="QLD")+factor(sex)+death+year, data = Aids2ann)
mod <- glm(outcome~factor(state=="QLD")+factor(sex)+death+year, family = binomial, data = Aids2ann)
mod1 <- glm(outcome~factor(state=="QLD"), family = binomial, data = Aids2ann)
mod2 <- glm(outcome~factor(sex), family = binomial, data = Aids2ann)
mod3 <- glm(outcome~death, family = binomial, data = Aids2ann)
mod4 <- glm(outcome~year, family = binomial, data = Aids2ann)
mod <- glm(outcome~factor(state=="QLD")+factor(sex)+death, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(state=="QLD")+factor(sex)+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(state=="QLD")+factor(sex)+death, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~age+factor(state=="QLD")+factor(sex)+death, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~age+factor(state=="QLD")+factor(sex)+year, family = binomial, data = Aids2ann)
mod <- glm(outcome~age+factor(state=="QLD")+factor(sex)+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~age+factor(state=="QLD")+factor(sex)+death, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(T.categ)+age+factor(state=="QLD")+factor(sex)+death, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(T.categ)+age+factor(state=="QLD")+factor(sex), family = binomial, data = Aids2ann)
summary(mod)
summary(mod1)
mod1 <- glm(outcome~factor(state=="QLD")+age+factor(sex)+death, family = binomial, data = Aids2ann)
summary(mod1)
lrtest (mod, mod1)
library(epicalc)
anova(mod)
anova(mod, mod1)
?lrtest
lrtest(mod, mod1)
lrtest(mod)
library(lmtest)
lrtest(mod)
lrtest(mod, mod1)
lrtest(mod1, mod)
lrtest(mod, mod1)
summary(mod)
summary(mod1)
1 - pchisq(7218.8, 6003)
1 - pchisq(6055.9, 6009)
mod1 <- glm(outcome~factor(state=="QLD")+age+death, family = binomial, data = Aids2ann)
summary(mod1)
mod1 <- glm(outcome~factor(state=="QLD")+age+factor(sex)+death, family = binomial, data = Aids2ann)
summary(mod1)
mod <- glm(outcome~factor(T.categ)+age+factor(state=="QLD"), family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(T.categ)+age+factor(state), family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(T.categ)+age+factor(state)+factor(sex), family = binomial, data = Aids2ann)
summary(mod)
1 - pchisq(7216.8, 6001)
mod <- glm(outcome~factor(T.categ)+age+factor(state)+factor(sex)+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(T.categ)+age+factor(state=="QLD")+factor(sex)+year, family = binomial, data = Aids2ann)
summary(mod)
aggr(Aids2ann)
library(VIM)
aggr(Aids2ann)
dim(Aids2ann)
### F    M
### 202 5812
### Females are way less than men -> the ratio between the two is less than 3.5%
### First thing which is odd about the dataset
barplot(Aids2ann$sex)
### F    M
### 202 5812
### Females are way less than men -> the ratio between the two is less than 3.5%
### First thing which is odd about the dataset
barplot(table(Aids2ann$sex))
boxplot(Aids2ann$age~Aids2ann$T.categ)
table(Aids2ann$T.categ)
barplot(table(Aids2ann$state))
barplot(table(Aids2ann$T.categ))
mod <- glm(outcome~factor(T.categ)+age+factor(state=="QLD")+factor(sex)+year, family = binomial, data = Aids2ann)
summary(mod)
mod1 <- glm(outcome~factor(state=="QLD")+age+factor(sex)+death, family = binomial, data = Aids2ann)
summary(mod1)
table(Aids2ann$state)
table(Aids2ann$T.categ)
unique(Aids2ann$year)
quantile(Aids2ann$diag,p=c(0,0.025,0.25,0.5,0.75,0.975,1))
plot(Aids2ann$diag,dnorm(Aids2ann$diag,mean=mu.diag,sd=sig.diag))
hist(Aids2ann$diag,freq=F)
points(Aids2ann$diag,dnorm(Aids2ann$diag,mean=mu.diag,sd=sig.diag))
qqnorm(Aids2ann$diag)
qqline(Aids2ann$diag)
quantile(Aids2ann$diag,p=c(0,0.025,0.25,0.5,0.75,0.975,1))
quantile(Aids2ann$death,p=c(0,0.025,0.25,0.5,0.75,0.975,1))
quantile(Aids2ann$diag,p=c(0,0.025,0.25,0.5,0.75,0.975,1))
h.diag
h.diag <- hist(Aids2ann$diag)
points(Aids2ann$diag,dnorm(Aids2ann$diag,mean=mu.diag,sd=sig.diag))
mu.diag <- mean(Aids2ann$diag)
sig.diag <- sd(Aids2ann$diag)
plot(Aids2ann$diag,dnorm(Aids2ann$diag,mean=mu.diag,sd=sig.diag))
hist(Aids2ann$diag,freq=F)
points(Aids2ann$diag,dnorm(Aids2ann$diag,mean=mu.diag,sd=sig.diag))
qqnorm(Aids2ann$diag)
qqline(Aids2ann$diag)
quantile(Aids2ann$death,p=c(0,0.025,0.25,0.5,0.75,0.975,1))
h.death <- hist(Aids2ann$death)
h.year <- hist(Aids2ann$year)
h.age <- hist(Aids2ann$age)
names(h.age)
h.age$breaks
h.age$counts
mu.age <- mean(Aids2ann$age)
sig.age <- sd(Aids2ann$age)
plot(Aids2ann$age,dnorm(Aids2ann$age,mean=mu.age,sd=sig.age))
hist(Aids2ann$age,freq=F)
points(Aids2ann$age,dnorm(Aids2ann$age,mean=mu.age,sd=sig.age))
qqnorm(Aids2ann$age)
qqline(Aids2ann$age)
boxplot(Aids2ann$age~Aids2ann$T.categ)
boxplot(Aids2ann$death~Aids2ann$T.categ)
boxplot(Aids2ann$diag~Aids2ann$T.categ)
table(Aids2ann$age, Aids2ann$T.categ)
chisq.test(Aids2ann$age, Aids2ann$T.categ)
boxplot(Aids2ann$year~Aids2ann$state)
chisq.test(Aids2ann$year, Aids2ann$state)
boxplot(Aids2ann$age~Aids2ann$state)
chisq.test(Aids2ann$age, Aids2ann$state)
chisq.test(Aids2ann$status, Aids2ann$T.categ)
chisq.test(Aids2ann$status, Aids2ann$state)
boxplot(Aids2ann$death~Aids2ann$status)
t.test(Aids2ann$death~Aids2ann$status)
plot(Aids2ann$diag, Aids2ann$death)
boxplot(Aids2ann$age~Aids2ann$T.categ)
t.test(Aids2ann$age~Aids2ann$T.categ)
t.test(Aids2ann$age~Aids2ann$T.categ=="mother")
t.test(Aids2ann$age~Aids2ann$T.categ=="hs")
t.test(Aids2ann$age~Aids2ann$T.categ=="mother")
t.test(Aids2ann$age~Aids2ann$T.categ=="blood")
t.test(Aids2ann$age~Aids2ann$T.categ=="hs")
t.test(Aids2ann$age~Aids2ann$T.categ=="het")
chisq.test(Aids2ann$status, Aids2ann$T.categ)
chisq.test(Aids2ann$status, Aids2ann$state)
boxplot(Aids2ann$death~Aids2ann$status)
plot(Aids2ann$diag, Aids2ann$death)
table(Aids2ann$death~Aids2ann$status)
boxplot(Aids2ann$death~Aids2ann$status)
chisq.test(Aids2ann$status, Aids2ann$T.categ)
plot(Aids2ann$diag, Aids2ann$death)
mod <- glm(outcome~factor(T.categ)+age+factor(state)+factor(sex)+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(T.categ)+age+factor(state=="QLD")+factor(sex)+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(T.categ)+age+year, family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(T.categ="het")+factor(T.categ="id")+age+year, family = binomial, data = Aids2ann)
mod <- glm(outcome~factor(T.categ=="het")+factor(T.categ=="id")+age+year, family = binomial, data = Aids2ann)
summary(mod)
mod1 <- glm(outcome~factor(state=="QLD")+age+factor(sex)+death+year, family = binomial, data = Aids2ann)
mod1 <- glm(outcome~factor(state=="QLD")+age+factor(sex)+year, family = binomial, data = Aids2ann)
summary(mod1)
mod <- glm(outcome~factor(T.categ=="het")+factor(T.categ=="id")+age+year+factor(state=="QLD"), family = binomial, data = Aids2ann)
summary(mod)
mod1 <- glm(outcome~factor(state=="QLD")+age+year, family = binomial, data = Aids2ann)
summary(mod1)
mod <- glm(outcome~factor(T.categ=="het")+factor(T.categ=="id")+age+year+factor(state=="QLD"), family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(T.categ=="het")+age+year+factor(state=="QLD"), family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(T.categ)+age+year+factor(state=="QLD"), family = binomial, data = Aids2ann)
summary(mod)
mod <- glm(outcome~factor(T.categ)+age+year+factor(state), family = binomial, data = Aids2ann)
summary(mod)
mod1 <- glm(outcome~factor(T.categ)+age+year, family = binomial, data = Aids2ann)
summary(mod1)
library(lmtest)
lrtest(mod, mod1)
lrtest(mod1, mod)
mod2 <- glm(outcome~factor(T.categ)+age+year+factor(state)+factor(sex), family = binomial, data = Aids2ann)
lrtest(mod1, mod2)
summary(mod2)
lrtest(mod1, mod3)
mod4 <- glm(outcome~deat+year, family = binomial, data = Aids2ann)
mod4 <- glm(outcome~death+year, family = binomial, data = Aids2ann)
summary(mod3)
lrtest(mod1, mod4)
summary(mod3)
mod1 <- glm(outcome~factor(T.categ)+age+year, family = binomial, data = Aids2ann)
summary(mod1)
mod4 <- glm(outcome~age+year+factor(T.categ)+factor(sex), family = binomial, data = Aids2ann)
summary(mod3)
summary(mod4)
lrtest(mod1, mod4)
lrtest(mod1, mod3)
mod1.resid <- resid(mod1)
plot(Aids2ann$year, mod1.resid)
plot(Aids2ann$outcome, mod1.resid)
plot(Aids2ann$age, mod1.resid)
plot(Aids2ann$T.categ, mod1.resid)
plot(Aids2ann$age, mod1.resid)
plot(Aids2ann$year, mod1.resid)
library(lmtest)
lrtest(mod1)
lrtest(mod1, mod)
mod.resid <- resid(mod)
plot(Aids2ann$year, mod.resid)
confint(mod1)
summary(mod1)
confint(mod1)
